## ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–´–ï —Å–ø–æ—Å–æ–±—ã –≤—ã—è–≤–ª–µ–Ω–∏—è –¥–µ–¥–ª–æ–∫–æ–≤ –∏ –≥–æ–ª–æ–¥–∞–Ω–∏—è**

### üîç **1. –î–ª—è –¥–µ–¥–ª–æ–∫–æ–≤ (Deadlocks)**

**–∞) JConsole / VisualVM (ÊúÄÁÆÄÂçï - —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)**
```bash
# –ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –≤–∞—à–µ–º—É Java-–ø—Ä–æ—Ü–µ—Å—Å—É
jconsole
# –∏–ª–∏
jvisualvm
```
- –í–æ –≤–∫–ª–∞–¥–∫–µ "Threads" –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "Detect Deadlock"

**–±) jstack - —É—Ç–∏–ª–∏—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏**
```bash
# –ù–∞–π—Ç–∏ PID –≤–∞—à–µ–≥–æ Java-–ø—Ä–æ—Ü–µ—Å—Å–∞
jps -l

# –ü–æ–ª—É—á–∏—Ç—å –¥–∞–º–ø –ø–æ—Ç–æ–∫–æ–≤
jstack <PID>

# –ò–ª–∏ —Å—Ä–∞–∑—É —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª
jstack <PID> > thread_dump.txt
```
**–ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –≤—ã–≤–æ–¥–µ:**
```
Found one Java-level deadlock:
=============================
```

**–≤) –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ**
```kotlin
fun checkForDeadlocks() {
    val threadBean = ManagementFactory.getThreadMXBean()
    val deadlockedThreads = threadBean.findDeadlockedThreads()
    
    if (deadlockedThreads != null) {
        println("–ù–∞–π–¥–µ–Ω –¥–µ–¥–ª–æ–∫ –≤ –ø–æ—Ç–æ–∫–∞—Ö: ${deadlockedThreads.joinToString()}")
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç.–¥.
    }
}

// –ó–∞–ø—É—Å–∫–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏
scheduledExecutor.scheduleAtFixedRate(::checkForDeadlocks, 1, 1, TimeUnit.MINUTES)
```

### üîç **2. –î–ª—è –≥–æ–ª–æ–¥–∞–Ω–∏—è (Starvation)**

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –≥–æ–ª–æ–¥–∞–Ω–∏—è:**
- **–í—ã—Å–æ–∫–∏–π CPU** –Ω–æ –Ω–∏–∑–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ù–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞**
- **–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ç–æ–∫–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è**

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:**

**–∞) APM-—Å–∏—Å—Ç–µ–º—ã (Application Performance Monitoring)**
- **Datadog**, **New Relic**, **AppDynamics**
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç latency, throughput –ø–æ –∫–∞–∂–¥–æ–º—É –ø–æ—Ç–æ–∫—É

**–±) JMX-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
```kotlin
fun monitorThreadStarvation() {
    val threadBean = ManagementFactory.getThreadMXBean()
    val allThreads = threadBean.dumpAllThreads(false, false)
    
    allThreads.forEach { threadInfo ->
        val blockedTime = threadInfo.blockedTime
        val waitedTime = threadInfo.waitedTime
        
        if (blockedTime > 10000 || waitedTime > 30000) { // 10 sec blocked, 30 sec waited
            println("–ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–û–ï –ì–û–õ–û–î–ê–ù–ò–ï: ${threadInfo.threadName} " +
                   "blocked: ${blockedTime}ms, waited: ${waitedTime}ms")
        }
    }
}
```

**–≤) Flight Recorder (JFR) - —Å–∞–º—ã–π –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**
```bash
# –ó–∞–ø—É—Å–∫ —Å JFR
java -XX:+UnlockDiagnosticVMOptions -XX:+DebugNonSafepoints -XX:+FlightRecorder \
-XX:StartFlightRecording=delay=5s,duration=60s,filename=recording.jfr \
-jar your-app.jar

# –ê–Ω–∞–ª–∏–∑ –∑–∞–ø–∏—Å–∏
jfr print recording.jfr
# –∏–ª–∏
jmc recording.jfr
```

**–ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ JFR:**
- **`jdk.JavaMonitorWait`** - —Å–æ–±—ã—Ç–∏—è –æ–∂–∏–¥–∞–Ω–∏—è
- **`jdk.ThreadPark`** - —Å–æ–±—ã—Ç–∏—è –ø–∞—Ä–∫–æ–≤–∫–∏ –ø–æ—Ç–æ–∫–æ–≤
- **`jdk.BlockedClass`** - –∫–∞–∫–∏–µ –∫–ª–∞—Å—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç

### üîç **3. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫–∏ (Profilers)**

**–∞) Async Profiler**
```bash
# –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö
./profiler.sh -e lock -d 30 -f lock_profile.html <PID>
```

**–±) VisualVM —Å –ø–ª–∞–≥–∏–Ω–∞–º–∏**
- **Threads** ‚Üí **Thread States** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–æ—Ç–æ–∫–æ–≤
- **Sampler** - —Å–µ–º–ø–ª—ã —Å—Ç–µ–∫–∞ –≤—ã–∑–æ–≤–æ–≤

---

## üéØ **–ö—Ä–∞—Ç–∫–∏–π —á–µ–∫–ª–∏—Å—Ç –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏**

**–î–ª—è –¥–µ–¥–ª–æ–∫–æ–≤:**
1. `jstack <PID>` - –∏—â–∏—Ç–µ "deadlock"
2. JConsole ‚Üí Threads ‚Üí Detect Deadlock
3. –í–∫–ª—é—á–∏—Ç—å `-XX:+PrintConcurrentLocks`

**–î–ª—è –≥–æ–ª–æ–¥–∞–Ω–∏—è:**
1. JFR –∑–∞–ø–∏—Å—å –Ω–∞ 1-2 –º–∏–Ω—É—Ç—ã
2. –°–º–æ—Ç—Ä–µ—Ç—å `jdk.JavaMonitorWait` —Å –±–æ–ª—å—à–µ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å `ThreadMXBean` –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –¥–æ–ª–≥–∏—Ö blockedTime

**–ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏–∫–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `ReentrantLock(true)` –¥–ª—è —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏
- –î–æ–±–∞–≤–ª—è–π—Ç–µ —Ç–∞–π–º–∞—É—Ç—ã –≤ `tryLock(timeout)`
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ —Å –ø–æ–º–æ—â—å—é Micrometer/Prometheus

---
